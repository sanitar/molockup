(function(a){a.widget("ui.wireframe",{options:{title:"wireframe",mockup_id:"1",project_id:"1"},init_vars:function(){this.elements={},this.workspace=a("#work_space"),this.elements_info=a("#elements_info"),this.current_layer={},this.layers_container=a("#layers"),molockup.content_menu=a("<div/>",{"class":"content_menu"}).appendTo("body").hide(),molockup.current_block_info=a("<div/>",{id:"current_block_info"}).css({position:"absolute",right:"20px",top:"20px",width:"300px",height:"30px"}).appendTo("body")},_create:function(){var b=this;this._load_blockpool(),molockup.block_id=0,molockup.blocks={},molockup.layer_id=0,molockup.layers=[],this.init_vars(),this.navigation=a("#navigation"),this.navigation.draggable({containment:"parent",axis:"x"}),a("#save_layout").click(function(){b._save_layout()}),a("#load_layout").click(function(){b._load_layout()}),this.element.click(function(){a("<div/>").mblock({content:"yo"})}),this.workspace.selectable({filter:".element"})},_save_layout:function(){for(var b in molockup.blocks)molockup.blocks[b].element.mblock("update_element_info");a.ajax({type:"POST",url:"/projects/"+this.options.project_id+"/mockups/"+this.options.mockup_id+"/save",data:{authenticity_token:a("meta[name=csrf-token]").attr("content"),mockup:{content:JSON.stringify(molockup.blocks)}},success:function(){console.log("done!")}})},_load_layout:function(){var b=this,c=a.ajax({type:"GET",url:"/projects/"+this.options.project_id+"/mockups/"+this.options.mockup_id+".json",success:function(a){b._draw_layout(a)},dataType:"json"})},_draw_layout:function(b){for(var c in b)a("<div/>").mblock({donor:b[c].element})},_load_blockpool:function(){a.ajax({type:"GET",url:"/blocks/pool",success:function(a){}})},_callback:function(b){a.isFunction(b)&&b.call(this)}})})(jQuery)